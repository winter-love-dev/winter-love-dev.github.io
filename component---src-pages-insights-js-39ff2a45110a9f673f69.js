"use strict";(self.webpackChunkwinter_love_dev=self.webpackChunkwinter_love_dev||[]).push([[310],{1850:function(e,t,n){n.r(t);var s=n(6540),i=n(4794),r=n(151),a=n(2022),l=n(2659),o=n(8819),c=n(3493),g=n(2030);const u=()=>s.createElement("div",{className:"insights-empty-message"},"You've seen all insights ðŸ¤—");t.default=e=>{let{data:t,location:n}=e;const h=(0,s.useMemo)((()=>t.allMarkdownRemark.edges.map((e=>{let{node:t}=e;return t}))),[t.allMarkdownRemark.edges]),m=(0,r.c)(t.profileImage),{nickname:d,bio:f}=t.site.siteMetadata.author,p={profileImage:m,nickname:d,role:f.role},{0:v,1:w}=(0,s.useState)((()=>{if("undefined"!=typeof window){return new URLSearchParams(n.search).get("tag")||null}return null})),E=(0,s.useMemo)((()=>v?h.filter((e=>(e.frontmatter.insightTags||[]).includes(v))):h),[h,v]),{0:I,1:S}=(0,s.useState)([]),{0:k,1:b}=(0,s.useState)(!0),{0:y,1:R}=(0,s.useState)(1),M=(0,s.useRef)(null),A=(0,s.useRef)(E),T=(0,s.useRef)(5),C=(0,s.useRef)(k),N=(0,s.useRef)(y);(0,s.useEffect)((()=>{A.current=E,C.current=k,N.current=y}),[E,k,y]),(0,s.useEffect)((()=>{if("undefined"==typeof window)return;const e=sessionStorage.getItem("insights-scroll"),t=sessionStorage.getItem("insights-loaded-count"),n=sessionStorage.getItem("insights-tag");if(t&&n===v){const n=parseInt(t,10),s=E.slice(0,n);S(s),R(Math.ceil(n/5)),b(n<E.length),e&&setTimeout((()=>{window.scrollTo(0,parseInt(e,10))}),100),sessionStorage.removeItem("insights-scroll"),sessionStorage.removeItem("insights-loaded-count"),sessionStorage.removeItem("insights-tag")}else{const e=E.slice(0,5);S(e),R(Math.ceil(1)),b(E.length>5),n!==v&&window.scrollTo(0,0)}}),[E,v]),(0,s.useEffect)((()=>{if("undefined"==typeof window)return;const e=new IntersectionObserver((e=>{if(e[0].isIntersecting&&C.current){console.log("Intersection Observer triggered - loading more...");const e=N.current+1,t=0,n=e*T.current,s=A.current.slice(t,n);S(s),R(e),b(n<A.current.length)}}),{threshold:.1,rootMargin:"200px"}),t=M.current;return t&&(console.log("Observer attached to target"),e.observe(t)),()=>{t&&e.unobserve(t)}}),[]);const _=e=>{"undefined"!=typeof window&&sessionStorage.setItem("insights-tag",e),w(e),(0,i.navigate)("/insights?tag="+encodeURIComponent(e))};return 0===h.length?s.createElement(o.A,{pageType:"insight"},s.createElement(c.A,{title:"Insights | Winter's archive"}),s.createElement(u,null)):s.createElement(o.A,{pageType:"insight"},s.createElement(c.A,{title:"Insights | Winter's archive"}),s.createElement("div",{className:"insights-container"},v&&s.createElement("div",{className:"insights-filter-bar"},s.createElement("button",{onClick:()=>{"undefined"!=typeof window&&sessionStorage.removeItem("insights-tag"),w(null),(0,i.navigate)("/insights")},className:"insights-read-all-button"},s.createElement(l.A,{style:{fontSize:"18px"}}),"Read all insights"),s.createElement(a.A,{label:"#"+v,className:"insights-filter-tag"}),s.createElement("span",{className:"insights-filter-count"},E.length," ",1===E.length?"insight":"insights")),I.map(((e,t)=>s.createElement(g.A,{key:e.id,insight:e,authorData:p,isDetailPage:!1,loadedCount:I.length,onTagClick:_}))),k&&s.createElement("div",{ref:M,style:{height:"20px"}}),!k&&I.length>0&&s.createElement(u,null)))}}}]);
//# sourceMappingURL=component---src-pages-insights-js-39ff2a45110a9f673f69.js.map